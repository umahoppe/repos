<!-- HTMLテンプレートのトップページ -->
<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>気象データ比較</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>
    <h1>🌾 地域・年別 気象データ比較</h1>

    <form method="get">
        <label>地域：</label>
        <select name="location">
            {% for name in location_list %}
            <option value="{{ name }}" {% if location==name %}selected{% endif %}>{{ name }}</option>
            {% endfor %}
        </select>

        <label>比較年（複数選択可）：</label>
        <select name="years" multiple size="6">
            {% for y in valid_years %}
            <option value="{{ y }}" {% if y|string in selected_years %}selected{% endif %}>{{ y }}</option>
            {% endfor %}
        </select>

        <button type="submit">表示</button>
    </form>


    {% if error %}
    <p class="error-message">{{ error }}</p>
    {% endif %}

    {% if labels %}
    <canvas id="tempChart" width="600" height="300"></canvas>
    <canvas id="rainChart" width="600" height="300"></canvas>

    <script>
        const labels = {{ labels | safe }};
        const tempData = {{ temp_data | safe }};
        const rainData = {{ rain_data | safe }};

        new Chart(document.getElementById('tempChart'), {
            type: 'line',
            data: { labels: labels, datasets: tempData },
            options: { plugins: { title: { display: true, text: '月別 平均気温（℃）' } } }
        });

        new Chart(document.getElementById('rainChart'), {
            type: 'bar',
            data: { labels: labels, datasets: rainData },
            options: { plugins: { title: { display: true, text: '月別 降水量合計（mm）' } } }
        });
    </script>
    {% endif %}
</body>

</html>
